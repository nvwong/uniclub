webpackJsonp([5],{41:function(e,t){"use strict";function n(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e){return{list:function(t){var n=t.page;return e.get("/api/users",{params:{page:n}})},register:function(t){return e.post("/api/users",{data:t})},verifyEmail:function(t){var n=t.token;return e.post("/api/users/email/verify",{data:{verifyEmailToken:n}})},requestVerifyEmail:function(t){return e.post("/api/users/email/request-verify",{data:t})},login:function(t){return e.post("/api/users/login",{data:t})},requestResetPassword:function(t){return e.post("/api/users/password/request-reset",{data:t})},resetPassword:function(t){var u=t.token,i=n(t,["token"]);return e.put("/api/users/password",{data:r({resetPasswordToken:u},i)})},logout:function(){return e.get("/api/users/logout")},readAny:function(t){return e.get("/api/users/edit",{params:{user:t}})},readSelf:function(){return e.get("/api/users/me")},update:function(t){return e.put("/api/users/me",{data:t})},updateAvatarURL:function(t){return e.put("/api/users/me/avatarURL",{data:t})},updatePassword:function(t){return e.put("/api/users/me/password",{data:t})},uploadAvatar:function(t){return e.post("/api/users/me/avatar",{files:{avatar:t}})}}}},46:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.apendEntitiesIntoPage=t.prependEntitiesIntoPage=t.setCrrentPage=t.setPages=void 0;var u=n(25),i=r(u),a=n(52);t.setPages=function(e,t,n){return{type:i.default.SET_PAGES,resource:e,page:t,ids:n}},t.setCrrentPage=function(e,t){return{type:i.default.SET_CURRENT_PAGE,resource:e,currentPage:t}},t.prependEntitiesIntoPage=function(e,t,n){return function(r,u){r((0,a.setEntities)(t)),r({type:i.default.PREPEND_ENTITIES_INTO_PAGE,resource:e,ids:t.result,intoPage:n})}},t.apendEntitiesIntoPage=function(e,t,n){return function(r,u){r((0,a.setEntities)(t)),r({type:i.default.APPEND_ENTITIES_INTO_PAGE,resource:e,ids:t.result,intoPage:n})}}},52:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.removeEntities=t.setEntities=void 0;var u=n(25),i=r(u);t.setEntities=function(e){return{type:i.default.SET_ENTITIES,normalized:e}},t.removeEntities=function(e,t){return{type:i.default.REMOVE_ENTITIES_FROM_PAGE,resource:e,ids:t}}},55:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n){e[t]=n}function i(e,t,n,r,i){var a=r.assignEntity,o=void 0===a?u:a,s=t&&t.getDefaults&&t.getDefaults(),c=t&&t.getAssignEntity&&t.getAssignEntity(),f=(0,j.default)(s)?g({},s):{};for(var l in e)if(e.hasOwnProperty(l)){var p="function"==typeof t[l]?t[l].call(null,e):t[l],h=d(e[l],p,n,r,i);o.call(null,f,l,h,e,t),c&&c.call(null,f,l,h,e,t)}return f}function a(e,t,n,r){return function(e,u){return d(e,t,n,r,u)}}function o(e,t,n,r){return function(u,i){var a=e.getSchemaKey(u),o=d(u,t[a],n,r,i);return{id:o,schema:a}}}function s(e,t,n,r){var u=t.getItemSchema(),i=a(t,u,n,r);return Array.isArray(e)?e.map(i):Object.keys(e).reduce(function(t,n){return t[n]=i(e[n],n),t},{})}function c(e,t,n,r){var u=t.getItemSchema();return o(t,u,n,r)(e)}function f(e,t,n){for(var r in t)t.hasOwnProperty(r)&&(e.hasOwnProperty(r)&&!(0,k.default)(e[r],t[r])?console.warn("When merging two "+n+', found unequal data in their "'+r+'" values. Using the earlier value.',e[r],t[r]):e[r]=t[r])}function l(e,t,n,r,u){var a=r.mergeIntoEntity,o=void 0===a?f:a,s=t.getKey(),c=t.getId(e,u);n.hasOwnProperty(s)||(n[s]={}),n[s].hasOwnProperty(c)||(n[s][c]={});var l=n[s][c],d=i(e,t,n,r,u);return o(l,d,s),c}function d(e,t,n,r,u){return(0,j.default)(e)&&(0,j.default)(t)?t instanceof b.default?l(e,t,n,r,u):t instanceof w.default?s(e,t,n,r):t instanceof O.default?c(e,t,n,r):i(e,t,n,r,u):e}function p(e){return(0,j.default)(e)&&(0,k.default)(Object.keys(e),Object.keys(e).map(function(t){return e[t]}))?Object.keys(e):e}function h(e,t){return new w.default(e,t)}function v(e,t){return new w.default(e,t)}function y(e,t){return new O.default(e,t)}function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!(0,j.default)(e))throw new Error("Normalize accepts an object or an array as its input.");if(!(0,j.default)(t)||Array.isArray(t))throw new Error("Normalize accepts an object for schema.");var r={},u=d(e,t,r,n);return{entities:r,result:p(u)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Schema=void 0;var g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.arrayOf=h,t.valuesOf=v,t.unionOf=y,t.normalize=m;var _=n(188),b=r(_),E=n(189),w=r(E),P=n(102),O=r(P),S=n(187),k=r(S),A=n(33),j=r(A);t.Schema=b.default},82:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchSchema=t.eventSchema=t.userSchema=t.todo2Schema=t.todoSchema=void 0;var r=n(55);t.todoSchema=new r.Schema("todos",{idAttribute:"_id"}),t.todo2Schema=new r.Schema("todo2",{idAttribute:"_id"}),t.userSchema=new r.Schema("users",{idAttribute:"_id"}),t.eventSchema=new r.Schema("events",{idAttribute:"_id"}),t.searchSchema=new r.Schema("search",{idAttribute:"_id"})},102:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(33),o=r(a),s=function(){function e(t,n){if(u(this,e),!(0,o.default)(t))throw new Error("UnionSchema requires item schema to be an object.");if(!n||!n.schemaAttribute)throw new Error("UnionSchema requires schemaAttribute option.");this._itemSchema=t;var r=n.schemaAttribute;this._getSchema="function"==typeof r?r:function(e){return e[r]}}return i(e,[{key:"getItemSchema",value:function(){return this._itemSchema}},{key:"getSchemaKey",value:function(e){return this._getSchema(e)}}]),e}();t.default=s},134:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.setUsers=t.logoutUser=t.loginUser=void 0;var u=n(55),i=n(82),a=n(47),o=r(a),s=n(106),c=n(52),f=n(46);t.loginUser=function(e){var t=e.token,n=e.data,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(e){return e((0,s.setCookies)({token:t,user:n},r))}},t.logoutUser=function(){return function(e){return Promise.all([e((0,s.removeCookie)("token")),e((0,s.removeCookie)("user"))])}},t.setUsers=function(e){return function(t,n){var r=(0,u.normalize)(e.users,(0,u.arrayOf)(i.userSchema));t((0,c.setEntities)(r)),t((0,f.setPages)(o.default.USER,e.page,r.result))}}},187:function(e,t,n){function r(e,t){return u(e,t)}var u=n(122);e.exports=r},188:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n(this,e),!t||"string"!=typeof t)throw new Error("A string non-empty key is required");this._key=t,this._assignEntity=r.assignEntity;var u=r.idAttribute||"id";this._getId="function"==typeof u?u:function(e){return e[u]},this._idAttribute=u,this._meta=r.meta,this._defaults=r.defaults}return r(e,[{key:"getAssignEntity",value:function(){return this._assignEntity}},{key:"getKey",value:function(){return this._key}},{key:"getId",value:function(e,t){return this._getId(e,t)}},{key:"getIdAttribute",value:function(){return this._idAttribute}},{key:"getMeta",value:function(e){if(!e||"string"!=typeof e)throw new Error("A string non-empty property name is required");return this._meta&&this._meta[e]}},{key:"getDefaults",value:function(){return this._defaults}},{key:"define",value:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}}]),e}();t.default=u},189:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(33),o=r(a),s=n(102),c=r(s),f=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(u(this,e),!(0,o.default)(t))throw new Error("ArraySchema requires item schema to be an object.");if(n.schemaAttribute){var r=n.schemaAttribute;this._itemSchema=new c.default(t,{schemaAttribute:r})}else this._itemSchema=t}return i(e,[{key:"getItemSchema",value:function(){return this._itemSchema}}]),e}();t.default=f},638:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),c=r(s),f=n(12),l=n(45),d=n(41),p=r(d),h=n(134),v=function(e){function t(){return u(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),o(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.dispatch,n=e.apiEngine;(0,p.default)(n).logout().catch(function(e){throw alert("Logout user fail"),e}).then(function(e){return t((0,h.logoutUser)())}).then(function(){return t((0,l.push)("/"))})}},{key:"render",value:function(){return null}}]),t}(c.default.Component);t.default=(0,f.connect)(function(e){return{apiEngine:e.apiEngine}})(v)}});